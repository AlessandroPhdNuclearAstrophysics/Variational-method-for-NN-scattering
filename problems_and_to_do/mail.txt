
Ciao Laura,

per fare il fit, come sai, sto riscrivendo il potenziale in modo da massimizzarne la velocità e salvare gli elementi di matrice invece di calcolargli gli stessi più volte.

Sono arrivato a riprodurre tutti gli scattering con la mia versione del potenziale e del codice per il variazionale per ilb 5, 10 e 15 (gli ottimizzati). Fino a NLO tutto funziona bene, ma per N3LO non c'è verso di riprodurre gli sfasamenti in accordo col tuo codice o col mio codice vecchio (che usa la stessa implementazione del potenziale). La differenza è minima, ma non insignificante (vedi allegato).

La cosa strana è che la struttura del potenziale è la stessa per 3P0, 3P1, e l'accoppiato 3P2-3F2. Il primo canale e l'accoppiato vengono riprodotti fedelmente. Così come tutti gli altri canali presi in considerazione.

Non trovo una giustificazione per la quale il 3P1 non funzioni, così ho stampato il potenziale in quel canale ed ho notato che il potenziale mio (riscritto in fortran e partendo da zero usando gli operatori in Mathematica, consistenti) è diverso da quello ottenuto con il codice di Rocco.

Ti chiedo gentilmente se puoi stamparmi anche tu il potenziale (senza EM) a ilb 15 se puoi e confermare che è diverso dai miei, perché io ho controllato i conti più volte e non ne esco.

Se hai altre idee, fammi sapere.
Alessandro

PS: la situazione è quindi
LO ILB=5

3S1 10  OK
3D2 10  OK

1S0 01  OK
1D2 01  OK

NLO ILB=10

1P1 00  OK

3S1 10  OK
3D2 10  OK

1S0 01  OK
1D2 01  OK

3P0 11  OK
3P1 11  OK
3P2 11  OK

N3LO ILB=15

1P1 00  OK

3S1 10  OK
3D2 10  OK

1S0 01  OK
1D2 01  OK

3P0 11  OK
3P1 11  NOPE
3P2 11  OK